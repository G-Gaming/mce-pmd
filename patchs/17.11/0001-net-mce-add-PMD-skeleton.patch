From 5cb40bab8aced732f82a9160e666b9c9118dba12 Mon Sep 17 00:00:00 2001
From: Wenbo Cao <caowenbo@mucse.com>
Date: Wed, 31 Aug 2022 09:26:56 +0000
Subject: [PATCH] mce driver init and enable build option for mce pmd

Signed-off-by: Wenbo Cao <caowenbo@mucse.com>
---
 config/common_base   | 5 +++++
 drivers/net/Makefile | 1 +
 mk/rte.app.mk        | 1 +
 3 files changed, 7 insertions(+)

diff --git a/config/common_base b/config/common_base
index e74febef48..34cb921046 100644
--- a/config/common_base
+++ b/config/common_base
@@ -316,6 +316,11 @@ CONFIG_RTE_LIBRTE_THUNDERX_NICVF_DEBUG_TX=n
 CONFIG_RTE_LIBRTE_THUNDERX_NICVF_DEBUG_DRIVER=n
 CONFIG_RTE_LIBRTE_THUNDERX_NICVF_DEBUG_MBOX=n

+#
+# Compile burst-oriented Mucse N10 PMD driver
+#
+CONFIG_RTE_LIBRTE_MCE_PMD=y
+
 #
 # Compile burst-oriented Cavium LiquidIO PMD driver
 #
diff --git a/drivers/net/Makefile b/drivers/net/Makefile
index ef09b4e160..c9532dd38b 100644
--- a/drivers/net/Makefile
+++ b/drivers/net/Makefile
@@ -66,6 +66,7 @@ DIRS-$(CONFIG_RTE_LIBRTE_SFC_EFX_PMD) += sfc
 DIRS-$(CONFIG_RTE_LIBRTE_PMD_SZEDATA2) += szedata2
 DIRS-$(CONFIG_RTE_LIBRTE_PMD_TAP) += tap
 DIRS-$(CONFIG_RTE_LIBRTE_THUNDERX_NICVF_PMD) += thunderx
+DIRS-$(CONFIG_RTE_LIBRTE_MCE_PMD) += mce
 DIRS-$(CONFIG_RTE_LIBRTE_VIRTIO_PMD) += virtio
 DIRS-$(CONFIG_RTE_LIBRTE_VMXNET3_PMD) += vmxnet3
 
diff --git a/mk/rte.app.mk b/mk/rte.app.mk
index 6a6a7452e2..0d19ba3b36 100644
--- a/mk/rte.app.mk
+++ b/mk/rte.app.mk
@@ -156,6 +156,7 @@ _LDLIBS-$(CONFIG_RTE_LIBRTE_SFC_EFX_PMD)    += -lrte_pmd_sfc_efx
 _LDLIBS-$(CONFIG_RTE_LIBRTE_PMD_SZEDATA2)   += -lrte_pmd_szedata2 -lsze2
 _LDLIBS-$(CONFIG_RTE_LIBRTE_PMD_TAP)        += -lrte_pmd_tap
 _LDLIBS-$(CONFIG_RTE_LIBRTE_THUNDERX_NICVF_PMD) += -lrte_pmd_thunderx_nicvf
+_LDLIBS-$(CONFIG_RTE_LIBRTE_MCE_PMD)     += -lrte_pmd_mce
 _LDLIBS-$(CONFIG_RTE_LIBRTE_VIRTIO_PMD)     += -lrte_pmd_virtio
 ifeq ($(CONFIG_RTE_LIBRTE_VHOST),y)
 _LDLIBS-$(CONFIG_RTE_LIBRTE_PMD_VHOST)      += -lrte_pmd_vhost
-- 
2.27.0

